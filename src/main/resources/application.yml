# Server Configuration
quarkus:
  http:
    port: 8085
  datasource:
    db-kind: oracle
    username: aaa
    password: Aaa!89nky78D
    reactive:
      url: oracle:thin:@localhost:1522/ORCL

      max-size: 150              # Increased from 20 to handle 1000 TPS
      event-loop-size: 32        # Increased from 8 for better parallelism
      idle-timeout: PT10M        # Reduced from 15M to free idle connections faster
      max-lifetime: PT30M        # Increased from 15M for connection stability
      cache-prepared-statements: true
      reconnect-attempts: 5      # Increased from 3 for better resilience
      reconnect-interval: PT1S   # Reduced from 2S for faster recovery
      shared: false
      name: oracle-pool
      additional-properties:
        oracle.jdbc.implicitStatementCacheSize: "500"      # Increased from 250
        oracle.jdbc.ReadTimeout: "60000"                   # Increased to 60s for high CPU/load scenarios
        oracle.net.CONNECT_TIMEOUT: "30000"                # Increased to 30s for connection establishment
        oracle.net.READ_TIMEOUT: "60000"                   # Socket-level read timeout (60s)
        oracle.jdbc.loginTimeout: "60"                     # Login timeout in seconds
        oracle.jdbc.defaultRowPrefetch: "200"              # Increased from 100 for batch operations
        oracle.jdbc.maxCachedBufferSize: "50"              # Added for LOB handling
        oracle.net.disableOob: "true"                      # Disable out-of-band breaks for performance
        oracle.jdbc.useFetchSizeWithLongColumn: "true"     # Optimize LONG column fetching
        oracle.net.keepAlive: "true"                       # Enable TCP keepalive for connection stability

  log:
    level: INFO
    console:
      format: "%d{yyyy-MM-dd HH:mm:ss,SSS} %-5p [%c{3.}] (%t) %s%e%n"
  console:
    color: true
# Kafka Configuration
mp:
  messaging:
    incoming:
      db-write-events:
        connector: smallrye-kafka
        topic: DC-DR
        bootstrap.servers: localhost:9092
        group.id: accounting-dc-group
        value.deserializer: io.quarkus.kafka.client.serialization.ObjectMapperDeserializer
        key.deserializer: org.apache.kafka.common.serialization.StringDeserializer
        auto.offset.reset: earliest
        enable.auto.commit: false          # Changed from true for better reliability
        max.poll.records: 500              # Increased from 100 for higher throughput
        max.poll.interval.ms: 60000        # Reduced from 300000 (5min to 1min)
        session.timeout.ms: 30000
        fetch.min.bytes: 1024              # Minimum bytes to fetch per poll
        fetch.max.wait.ms: 500             # Max wait time for fetch
        max.partition.fetch.bytes: 1048576 # 1MB per partition
        failure-strategy: dead-letter-queue # Changed from ignore to handle failures properly
        dead-letter-queue.topic: DC-DR-DLQ # Dead letter queue topic
        throttled.unprocessed-record-max-age.ms: 60000 # Max age for unprocessed records